{
  "project": {
    "name": "PricePulse",
    "type": "MVP Sales Aggregator (UK Clothing)",
    "summary": "Aggregate sale items from top UK clothing retailers into one feed. Users can save items to a watchlist, set target-price alerts, and get email notifications. Includes a basic admin dashboard to manage stores and crawl runs."
  },
  "domain": {
    "registrar": "Namecheap",
    "primary": "TBD",
    "www": "TBD",
    "frontendHosting": "Vercel",
    "backendHosting": "Heroku",
    "dnsRecords": [
      {
        "type": "A",
        "host": "@",
        "value": "76.76.21.21",
        "ttl": "Automatic",
        "purpose": "Point apex domain to Vercel"
      },
      {
        "type": "CNAME",
        "host": "www",
        "value": "cname.vercel-dns.com",
        "ttl": "Automatic",
        "purpose": "Point www subdomain to Vercel"
      }
    ],
    "cleanup": [
      "Remove any parking/URL redirect records",
      "Remove any existing A record for @ that isn't 76.76.21.21",
      "Remove any existing CNAME for www that isn't cname.vercel-dns.com"
    ],
    "optionalBackendSubdomain": {
      "enabled": false,
      "subdomain": "api",
      "fqdn": "api.<your-domain>",
      "dns": {
        "type": "CNAME",
        "host": "api",
        "value": "your-heroku-app.herokuapp.com",
        "ttl": "Automatic"
      },
      "frontendEnvExample": {
        "VITE_API_URL": "https://api.<your-domain>"
      }
    },
    "domainSuggestions": [
      "getpricepulse.com",
      "pricepulseapp.com",
      "pricepulseuk.com",
      "trypricepulse.com",
      "pricepulse.co",
      "pricepulse.io"
    ]
  },
  "mvp_scope": {
    "stores_top6": [
      "Boohoo",
      "ASOS",
      "Zara",
      "PrettyLittleThing",
      "River Island",
      "SHEIN"
    ],
    "core_features": [
      "Unified deals feed (scraped sale items)",
      "Search + basic filters (store, price range)",
      "Product detail page (price, images, retailer link)",
      "Watchlist (save/remove products)",
      "Price alerts (target price)",
      "Email notifications for triggered alerts",
      "Authentication (Clerk)",
      "Premium gating (30-day trial + Â£3.99 lifetime)",
      "Admin dashboard (stores + crawl runs + manual triggers)"
    ],
    "not_in_mvp": [
      "Recommendations",
      "Referral program",
      "Saved searches",
      "Push notifications",
      "Advanced analytics",
      "Queue system (BullMQ + Redis)"
    ]
  },
  "tech_stack": {
    "frontend": {
      "framework": "React",
      "bundler": "Vite",
      "hosting": "Vercel",
      "domainRegistrar": "Namecheap",
      "env": ["VITE_API_URL", "VITE_CLERK_PUBLISHABLE_KEY"]
    },
    "backend": {
      "runtime": "Node.js",
      "framework": "Express",
      "hosting": "Heroku",
      "jobs": "Heroku Scheduler",
      "env": [
        "PORT",
        "MONGO_URI",
        "CLERK_SECRET_KEY",
        "STRIPE_SECRET_KEY",
        "STRIPE_WEBHOOK_SECRET",
        "ADMIN_USER_IDS"
      ]
    },
    "database": {
      "provider": "MongoDB Atlas",
      "orm": "Mongoose"
    },
    "authentication": {
      "provider": "Clerk",
      "userKey": "clerkUserId"
    },
    "scraping": {
      "crawlerFramework": "Crawlee",
      "browserAutomation": "Playwright",
      "adapterPattern": "One scraper per store (per-store adapter folders)"
    },
    "payments": {
      "provider": "Stripe",
      "product": "Lifetime deal",
      "priceGBP": 3.99
    },
    "notifications": {
      "channel": "email",
      "providerTBD": true
    }
  },
  "roles_access": {
    "admin_auth": {
      "provider": "Clerk",
      "mvp_method": "Allowlist of admin Clerk userIds in ENV",
      "envKey": "ADMIN_USER_IDS",
      "formatExample": "user_123,user_456"
    },
    "permissions": {
      "user": ["view products", "watchlist", "alerts", "billing"],
      "admin": [
        "manage stores",
        "trigger crawls",
        "view crawl runs",
        "view scraper errors"
      ]
    }
  },
  "data_models": {
    "Store": {
      "fields": [
        "name",
        "baseUrl",
        "enabled",
        "crawlFrequencyHours",
        "lastCrawlAt",
        "notes"
      ]
    },
    "Product": {
      "fields": [
        "canonicalKey",
        "store",
        "title",
        "price",
        "originalPrice",
        "discountPercent",
        "images",
        "productUrl",
        "lastSeenAt"
      ]
    },
    "PriceHistory": {
      "fields": ["productId", "price", "timestamp"]
    },
    "UserProfile": {
      "fields": ["clerkUserId", "plan", "trialEndsAt", "premiumActive"]
    },
    "WatchlistItem": {
      "fields": ["userId", "productId", "createdAt"]
    },
    "Alert": {
      "fields": [
        "userId",
        "productId",
        "targetPrice",
        "active",
        "lastTriggeredAt",
        "cooldownHours"
      ]
    },
    "CrawlRun": {
      "fields": [
        "store",
        "runType",
        "status",
        "startedAt",
        "endedAt",
        "stats",
        "errors"
      ]
    }
  },
  "scraping_mvp": {
    "approach": "One scraper per store using Crawlee + Playwright. Output normalized products into MongoDB.",
    "pipeline": [
      "Visit sale/category pages",
      "Extract product cards (title, price, image, url)",
      "Upsert Product by canonicalKey",
      "Append PriceHistory snapshot",
      "Write CrawlRun report"
    ],
    "canonical_key_strategy": "canonicalKey = store + ':' + normalizedProductUrlHash (or store + ':' + retailerProductId if available)",
    "scheduling": {
      "tool": "Heroku Scheduler",
      "recommendedJobs": [
        {
          "name": "crawl_all_stores",
          "frequency": "every 6 hours",
          "command": "node server/scripts/runCrawlAll.js"
        }
      ]
    }
  },
  "alerts_mvp": {
    "rule": "Trigger when product.price <= alert.targetPrice",
    "cooldown": { "defaultHours": 24 },
    "channel": "email",
    "scheduling": {
      "tool": "Heroku Scheduler",
      "recommendedJobs": [
        {
          "name": "evaluate_alerts",
          "frequency": "hourly",
          "command": "node server/scripts/runAlerts.js"
        }
      ]
    }
  },
  "admin_dashboard_mvp": {
    "screens": [
      {
        "id": "admin_overview",
        "name": "Overview",
        "shows": [
          "store status",
          "last crawl time",
          "latest crawl result summary"
        ]
      },
      {
        "id": "admin_stores",
        "name": "Stores",
        "shows": [
          "store name",
          "enabled",
          "crawlFrequencyHours",
          "lastCrawlAt"
        ],
        "actions": ["enable/disable store", "edit crawlFrequencyHours"]
      },
      {
        "id": "admin_crawls",
        "name": "Crawl Runs",
        "shows": ["recent runs", "status", "stats", "errors"],
        "actions": [
          "manual trigger crawl per store",
          "manual trigger all stores"
        ]
      }
    ],
    "admin_only_api": [
      "GET /api/admin/stores",
      "PUT /api/admin/stores/:name { enabled, crawlFrequencyHours }",
      "GET /api/admin/crawls?store=&status=&page=&limit=",
      "POST /api/admin/crawls/run { store, runType }",
      "POST /api/admin/crawls/run-all { runType }"
    ],
    "guarding": {
      "middleware": "requireAdmin",
      "rule": "Check Clerk userId is in ADMIN_USER_IDS env"
    }
  },
  "api_mvp": {
    "public": [
      "GET /api/products (filters: store, minPrice, maxPrice, q, page, limit)",
      "GET /api/products/:id"
    ],
    "authed": [
      "GET /api/me",
      "GET /api/watchlist",
      "POST /api/watchlist { productId }",
      "DELETE /api/watchlist/:productId",
      "GET /api/alerts",
      "POST /api/alerts { productId, targetPrice }",
      "PUT /api/alerts/:id { active, targetPrice }",
      "DELETE /api/alerts/:id"
    ],
    "billing": ["POST /api/billing/checkout", "POST /api/billing/webhook"],
    "admin": [
      "GET /api/admin/stores",
      "PUT /api/admin/stores/:name",
      "GET /api/admin/crawls",
      "POST /api/admin/crawls/run",
      "POST /api/admin/crawls/run-all"
    ]
  },
  "pricing": {
    "trial": {
      "enabled": true,
      "durationDays": 30,
      "planId": "free_trial",
      "limits": { "watchlistMax": 50, "alertsMax": 25 }
    },
    "lifetime": {
      "enabled": true,
      "planId": "lifetime",
      "priceGBP": 3.99,
      "limits": { "watchlistMax": null, "alertsMax": null }
    }
  },
  "deployment": {
    "frontend": {
      "platform": "Vercel",
      "domainRegistrar": "Namecheap",
      "domain": "TBD"
    },
    "backend": {
      "platform": "Heroku",
      "scheduler": "Heroku Scheduler"
    },
    "database": {
      "platform": "MongoDB Atlas"
    }
  },
  "mvp_build_phases": [
    {
      "phase": "1_foundation",
      "deliverables": [
        "Repo structure (client/server)",
        "Clerk auth wired",
        "Mongo models",
        "Products API + basic React feed UI"
      ]
    },
    {
      "phase": "2_scraping",
      "deliverables": [
        "Scraper template",
        "Implement 2 stores first",
        "Scale to Top 6",
        "Scheduled runs + DB upserts + CrawlRun logging"
      ]
    },
    {
      "phase": "3_watchlist_alerts",
      "deliverables": ["Watchlist CRUD", "Alerts CRUD", "Email alert job"]
    },
    {
      "phase": "4_admin_dashboard",
      "deliverables": [
        "Admin auth guard (allowlist)",
        "Admin APIs: stores + crawl runs + triggers",
        "Admin UI screens (overview, stores, crawl runs)"
      ]
    },
    {
      "phase": "5_premium",
      "deliverables": [
        "30-day trial gating",
        "Stripe lifetime purchase + webhook",
        "Premium flags stored in DB"
      ]
    }
  ]
}
